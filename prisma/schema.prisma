generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Users table
model User {
  id        Int       @id @default(autoincrement())
  name      String
  email     String    @unique
  phone     String    @unique
  password  String? // optional for guest users
  feedback  Boolean   @default(false)
  isGuest   Boolean   @default(false)
  bookings  Booking[]
  botToken  String?
  zoho_visitor_id String? @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

// Cities table
// model City {
//   id           Int           @id @default(autoincrement())
//   name         String        @unique
//   parkingAreas ParkingArea[]
// }

// Parking areas
model ParkingArea {
  id         Int           @id @default(autoincrement())
  city       String
  name       String        @unique
  totalSlots Int
  address    String?
  slots      ParkingSlot[]
  createdAt  DateTime      @default(now())
  updatedAt  DateTime      @updatedAt
}

// Individual parking slots
model ParkingSlot {
  id          Int         @id @default(autoincrement())
  parkingArea ParkingArea @relation(fields: [parkingId], references: [id])
  parkingId   Int
  slotNumber  String

  bookings    Booking[]
}

// Bookings table
model Booking {
  id            Int         @id @default(autoincrement())
  user          User?       @relation(fields: [userId], references: [id])
  userId        Int?
  slot          ParkingSlot @relation(fields: [slotId], references: [id])
  slotId        Int
  startTime     DateTime
  endTime       DateTime
  phone         String
  paymentStatus String      @default("pending") // pending, paid, failed
  amount        Float?
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
}

